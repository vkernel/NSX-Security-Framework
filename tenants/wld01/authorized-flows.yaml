---
wld01:
  emergency_policy:   
    - name: Allow emergency rule on VMs with this tag   
      source: 
        - emg-wld01
      destination: 
        - any
      scope_enabled: true  
  environment_policy:
    allowed_communications:
      - name: Allow prod environment to test environment
        source: env-wld01-prod
        destination: env-wld01-test
        scope_enabled: true  
    blocked_communications:
      - name: Block test environment from prod environment
        source: env-wld01-test
        destination: env-wld01-prod
        scope_enabled: true  
  application_policy:
    - name: Allow jumphost to ten-wld01 on port 22
      source: ext-wld01-jumphosts
      destination: 
        - ten-wld01
      services:
        - SSH
      scope_enabled: false  
    - name: Allow jumphost to web servers on port 443
      source: ext-wld01-jumphosts
      destination: 
        - app-wld01-prod-3holapp-web
        - app-wld01-prod-web
        - app-wld01-test-web
      services:
        - ICMPv4
      ports:
        - 443
      protocol: tcp
      scope_enabled: true  
    - name: Allow jumphost to ten-wld01 servers on ICMPv4
      source: ext-wld01-jumphosts
      destination: 
        - ten-wld01
      services:
        - ICMPv4
      ports:
        - 445
      protocol: tcp
      scope_enabled: true  
    - name: Allow web servers to application servers on port 8443
      source: 
        - app-wld01-prod-3holapp-web
        - app-wld01-prod-web
        - app-wld01-test-web
      destination: 
        - app-wld01-prod-3holapp-application
        - app-wld01-prod-application
        - app-wld01-test-application
      services:
        - ICMPv4
      ports: 
        - 8443
      protocol: tcp
      scope_enabled: true  
    - name: Allow application servers to database servers on port 3306
      source: 
        - app-wld01-prod-3holapp-application
        - app-wld01-prod-application
        - app-wld01-test-application
      destination: 
        - app-wld01-prod-3holapp-database
        - app-wld01-prod-database
        - app-wld01-test-database
      services:
        - ICMPv4
      ports:
        - 3306
      protocol: tcp
      scope_enabled: true  
    - name: Allow wld01 servers to external DNS on port 53
      source: ten-wld01
      destination: ext-wld01-dns
      ports:
        - 53
      protocol: udp
      scope_enabled: true  
    - name: Example of context profiles
      source: ten-wld01
      destination: ext-wld01-dns
      context_profiles:
        - DNS
        - SSL 
      context_profile_attributes:   
        app_id: 
          - "ACTIVDIR"   # Predefined App ID
          - "AMQP"   # Predefined App ID
        domain:
          - "*.microsoft.com"      # Predefined domain pattern
          - "*.office365.com"      # Predefined domain pattern
          - "*.teams.microsoft.com" # Predefined domain pattern
          - "*.vkernel.nl"         # Custom domain pattern
      scope_enabled: true  